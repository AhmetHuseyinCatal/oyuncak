<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Proje: Gizli Nefes Barƒ±</title>
    <style>
        /* --- GENEL TASARIM --- */
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #2f3640;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none; 
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        /* --- BARLARIN OLDUƒûU ALAN --- */
        .bars-container {
            width: 300px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-height: 50px; /* Barlarƒ±n yeri sabit kalsƒ±n */
        }

        .bar-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            transition: opacity 0.3s ease; /* Yumu≈üak g√∂r√ºnme efekti */
        }

        /* Nefes barƒ± ba≈ülangƒ±√ßta gizli olacak */
        #breath-container {
            opacity: 0; 
        }

        .bar-label { font-weight: bold; font-size: 14px; width: 50px; }

        .bar-box {
            flex-grow: 1;
            height: 20px;
            background-color: #555;
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid #777;
        }

        .bar-fill {
            height: 100%;
            width: 100%; 
            transition: width 0.2s linear; 
        }

        #health-fill { background-color: #e74c3c; box-shadow: 0 0 10px #e74c3c; } 
        #breath-fill { background-color: #3498db; box-shadow: 0 0 10px #3498db; } 

        /* --- BUTONLAR --- */
        .actions-container {
            background: #353b48;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .action-btn {
            padding: 12px 15px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            -webkit-tap-highlight-color: transparent;
        }

        #btn-tokat { background-color: #ff9f43; }
        #btn-yumruk { background-color: #ee5253; }
        #btn-tekme { background-color: #2e86de; }
        #btn-bogma { background-color: #5f27cd; }
        
        #btn-reset { 
            background-color: #44bd32; 
            margin-top: 20px; 
            z-index: 2000; 
            width: 200px; 
            padding: 15px;
            position: relative;
        }

        /* --- KARAKTER SAHNESƒ∞ --- */
        .character-stage {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #the-man {
            width: 100%;
            height: 100%;
            object-fit: contain;
            z-index: 1;
        }

        /* --- EFEKTLER --- */
        .prop {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            pointer-events: none;
            z-index: 10;
        }

        .emoji-prop { font-size: 100px; }
        #prop-bogma { width: 250px; height: auto; }
        #prop-ilac { width: 150px; height: auto; }

        /* --- GAME OVER EKRANI --- */
        #game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.85);
            z-index: 999;
            display: none; 
            flex-direction: column;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        #game-over-img {
            max-width: 80%;
            max-height: 50%;
            border: 3px solid white;
            border-radius: 15px;
            box-shadow: 0 0 50px red;
            animation: pulse 2s infinite;
            margin-bottom: 20px;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- ANƒ∞MASYONLAR --- */
        @keyframes slapHand { 0% { transform: translate(-250%, -50%); opacity:1;} 50% { transform: translate(-70%, -40%) ; opacity:1;} 100% { opacity:0; } }
        @keyframes punchHand { 0% { transform: translate(200%, 70%) scale(0.5) rotate(-45deg); opacity:1;} 50% { transform: translate(-30%, -60%) scale(1.5) rotate(-45deg); opacity:1;} 100% { opacity:0; } }
        @keyframes kickFoot { 0% { transform: translate(-300%, -300%) scale(0.2) rotate(45deg); opacity:1;} 50% { transform: translate(-200%, -170%); opacity:1; scale: 0.3;} 100% {transform: translate(-200%, -170%) rotate(-45deg); opacity:0; scale: 0.2; } }
        @keyframes chokeProcess { 0% { transform: translate(150%, -50%) scale(1); opacity: 0; } 15% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 80% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(0); opacity: 0; } }
        @keyframes healAnim { 0% { transform: translate(-250%, -50%) scale(0.5); opacity: 0; } 30% { transform: translate(-95%, -30%) scale(1.2); opacity: 1; } 70% { transform: translate(-100%, -5%) scale(1); opacity: 1; } 100% { transform: translate(-50%, -150%) scale(0.5); opacity: 0; } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
        .apply-shake { animation: shake 0.5s; }

    </style>
</head>
<body>

    <div class="bars-container">
        <div class="bar-wrapper">
            <span class="bar-label">CAN</span>
            <div class="bar-box"><div id="health-fill" class="bar-fill"></div></div>
        </div>
        
        <div id="breath-container" class="bar-wrapper">
            <span class="bar-label">NEFES</span>
            <div class="bar-box"><div id="breath-fill" class="bar-fill"></div></div>
        </div>
    </div>

    <div class="actions-container">
        <button id="btn-tokat" class="action-btn">‚úã Tokat</button>
        <button id="btn-yumruk" class="action-btn">üëä Yumruk</button>
        <button id="btn-tekme" class="action-btn">ü¶µ Tekme</button>
        <button id="btn-bogma" class="action-btn">üëê Boƒüma</button>
    </div>

    <div class="character-stage">
        <img id="the-man" src="normal.png" onerror="this.src='normal.jpg'" alt="Karakter">
        
        <img id="prop-tokat" class="prop" src="tokatel.png">
        <div id="prop-yumruk" class="prop emoji-prop">ü•ä</div>
        <img id="prop-tekme" class="prop" src="tekmeayak.png">
        <img id="prop-bogma" class="prop" src="boganel.png">
        <img id="prop-ilac" class="prop" src="ilac.png" alt="ƒ∞la√ß">
    </div>

    <p id="status-text" style="margin-top:20px; font-weight:bold;">Hazƒ±r</p>
    
    <button id="btn-reset" class="action-btn">üíä ƒ∞yile≈ütir</button>

    <div id="game-over-screen">
        <h1 style="color:red; font-size:40px; margin-bottom: 20px;">Oyun Bitti!</h1>
        <img id="game-over-img" src="son.png" alt="Son">
        <p style="margin-top:20px; color: #ddd;">Tekrar oynamak i√ßin "ƒ∞yile≈ütir"e bas.</p>
    </div>

    <script>
        const man = document.getElementById('the-man');
        const statusText = document.getElementById('status-text');
        
        // Bar Elementleri
        const healthFill = document.getElementById('health-fill');
        const breathFill = document.getElementById('breath-fill');
        const breathContainer = document.getElementById('breath-container'); // Yeni ekledik
        const gameOverScreen = document.getElementById('game-over-screen');

        // Deƒüi≈ükenler
        let currentHealth = 100;
        let currentBreath = 100;
        let isGameActive = true;
        
        let chokeInterval; // Nefes azaltma sayacƒ±
        let chokeStartTimer; // Gecikmeli ba≈ülatma sayacƒ±

        function changeImage(imageNameWithExt) {
            if (!isGameActive) return; 
            man.src = imageNameWithExt;
            man.onerror = function() {
                statusText.textContent = "HATA: " + imageNameWithExt + " bulunamadƒ±!";
                statusText.style.color = "#ee5253";
            };
        }

        function checkGameOver() {
            if (currentHealth <= 0 || currentBreath <= 0) {
                isGameActive = false;
                
                // T√ºm saya√ßlarƒ± durdur
                clearInterval(chokeInterval); 
                clearTimeout(chokeStartTimer);
                
                breathContainer.style.opacity = '0'; // Nefes barƒ±nƒ± gizle

                document.querySelectorAll('.prop').forEach(el => { el.style.opacity = '0'; });
                
                gameOverScreen.style.display = 'flex';
                statusText.textContent = "Eyvah! Adam gitti...";
            }
        }

        function updateBars() {
            healthFill.style.width = currentHealth + "%";
            breathFill.style.width = currentBreath + "%";
            
            if(currentHealth < 30) healthFill.style.backgroundColor = "#c0392b";
            else healthFill.style.backgroundColor = "#e74c3c";
        }

        function yaziGetir(metin, saniye) {
            if (!isGameActive) return;
            statusText.textContent = ""; 
            setTimeout(() => {
                if (isGameActive) {
                    statusText.textContent = metin;
                    statusText.style.color = "white"; 
                }
            }, saniye * 1000); 
        }

        function playAction(type) {
            if (!isGameActive) return; 

            // --- TEMƒ∞ZLƒ∞K ---
            // Herhangi bir tu≈üa basƒ±ldƒ±ƒüƒ±nda √∂nceki boƒüma i≈ülemlerini iptal et
            clearInterval(chokeInterval); 
            clearTimeout(chokeStartTimer);

            // Ekrandaki diƒüer efektleri temizle
            document.querySelectorAll('.prop').forEach(el => {
                el.style.animation = 'none';
                el.style.opacity = '0';
            });

            const prop = document.getElementById('prop-' + type);
            if (prop) {
                prop.style.animation = 'none';
                prop.offsetHeight; 
                
                // --- BOƒûMA ---
                if(type === 'bogma') {
                    statusText.textContent = ""; 
                    prop.style.animation = 'chokeProcess 1s ease-in-out forwards'; 
                    
                    // 1. Nefes barƒ±nƒ± g√∂ster
                    breathContainer.style.opacity = '1';

                    // 2. Gecikmeli Ba≈ülatma (1 saniye sonra nefes azalmaya ba≈ülasƒ±n)
                    chokeStartTimer = setTimeout(() => {
                        // Saya√ß ba≈üladƒ±
                        chokeInterval = setInterval(() => {
                            currentBreath -= 2; 
                            updateBars();
                            checkGameOver();
                        }, 100);
                    }, 1000); // 1000ms gecikme

                    setTimeout(() => {
                        changeImage('bogan.png'); 
                        man.classList.add('apply-shake'); 
                    }, 1000);
                    
                    yaziGetir("A≈ükƒ±mm! Tamam nefes alamƒ±yorummmm!", 1.3);
                } 
                // --- Dƒ∞ƒûERLERƒ∞ (Tokat, Yumruk, Tekme) ---
                else {
                    // Boƒüma iptal edildiƒüi i√ßin Nefesi doldur ve barƒ± gizle
                    currentBreath = 100;
                    updateBars();
                    breathContainer.style.opacity = '0'; // Barƒ± gizle

                    // Can Azaltma
                    if(type === 'tokat') currentHealth -= 10;
                    if(type === 'yumruk') currentHealth -= 20;
                    if(type === 'tekme') currentHealth -= 25;
                    updateBars();
                    checkGameOver();
                    
                    if (!isGameActive) return; 

                    statusText.textContent = ""; 

                    if(type === 'tokat') {
                        prop.style.animation = 'slapHand 0.7s forwards';
                        setTimeout(() => changeImage('tokat.png'), 200);
                        yaziGetir("Bitanem bu acƒ±dƒ± ama y√ºz√ºm kƒ±zardƒ± ya!", 0.3);
                    }
                    if(type === 'yumruk') {
                        prop.style.animation = 'punchHand 0.4s forwards';
                        setTimeout(() => changeImage('yumruk.png'), 200);
                        yaziGetir("Benim bi sol g√∂z√ºm vardƒ± ya artƒ±k yok!", 0.3);
                    }
                    if(type === 'tekme') {
                        prop.style.animation = 'kickFoot 1s forwards';
                        setTimeout(() => changeImage('tekme.png'), 200);
                        yaziGetir("Botunun tadƒ±da pek lezizmi≈ü", 0.3);
                    }
                    man.className = '';
                    void man.offsetWidth;
                    man.classList.add('apply-shake');
                }
            }
        }

        document.getElementById('btn-tokat').addEventListener('click', () => playAction('tokat'));
        document.getElementById('btn-yumruk').addEventListener('click', () => playAction('yumruk'));
        document.getElementById('btn-tekme').addEventListener('click', () => playAction('tekme'));
        document.getElementById('btn-bogma').addEventListener('click', () => playAction('bogma'));

        // --- ƒ∞Yƒ∞LE≈ûTƒ∞R BUTONU ---
        document.getElementById('btn-reset').addEventListener('click', () => {
            
            gameOverScreen.style.display = 'none'; 
            isGameActive = true;
            
            // Sƒ±fƒ±rlama i≈ülemleri
            currentHealth = 100;
            currentBreath = 100;
            updateBars();
            clearInterval(chokeInterval);
            clearTimeout(chokeStartTimer);
            breathContainer.style.opacity = '0'; // Nefes barƒ±nƒ± gizle

            statusText.textContent = "ƒ∞yile≈ütiriliyor...";
            
            const ilac = document.getElementById('prop-ilac');
            ilac.style.animation = 'none';
            ilac.offsetHeight; 
            ilac.style.animation = 'healAnim 2s ease-in-out forwards';

            setTimeout(() => {
                changeImage('iyilesti.png'); 
                man.className = '';
                statusText.textContent = "Eskisinden b√∂le daha iyi!";
            }, 1000);

            document.querySelectorAll('.prop').forEach(el => {
                if(el.id !== 'prop-ilac') {
                    el.style.animation = 'none';
                    el.style.opacity = '0';
                }
            });
        });

    </script>
</body>
</html>